<style>
.notefield{
  width: 100%;
  resize: none;
  font-size: 18px;
  height: 100px;
  border-radius: 3px;
}
.blankmessage{
  font-style: italic;
}
.note-content{
  border: 1px dashed black;
  border-radius: 5px;
  width: 50%;
  padding: 5px;
  word-wrap: break-word;
}
.email__subject{
  width: 100%;
}
.email__body{
  width: 100%;
  height: 300px;
  font-size: 18px;
}
</style>
<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="heading<%= feedback_message.id %>">
      <h2 class="panel-title">
        <a href="#collapse<%= feedback_message.id %>" role="button" data-toggle="collapse" data-parent="#accordion" aria-expanded="true" aria-controls="collapse<%= feedback_message.id %>">
          Report #<%= feedback_message.id %> - Submitted on: <%= feedback_message.to_eastern_strftime(feedback_message.created_at) %>
        </a>

      </h2>
    </div>
    <div class="panel-collapse collapse in" id="collapse<%= feedback_message.id %>" role="tabpanel" aria-labelledby="heading<%= %>">
      <div class="panel-body">
      <h2>
        Reporter:
        <% if feedback_message.reporter_id? %>
          <%= feedback_message.reporter.name %>
          <a href="<%= feedback_message.reporter.path %>">@<%= feedback_message.reporter.username %></a>
        <% else %>
          Anonymous
        <% end %>
      </h2>
      <h3>
        Reported URL (new tab):
        <br>
        <a href="<%= feedback_message.reported_url %>" target="_blank"><%= feedback_message.reported_url %></a>
      </h3>
      <h3>Category: <%= feedback_message.category %></h3>
      <h3>
        Message:
      </h3>
      <p>
        <% if feedback_message.message.blank? %>
          <span class="blankmessage">No message was left.</span>
        <% else %>
          <%= feedback_message.message %>
        <% end %>
      </p>
      <h3>
        Status:  <%= f.select :status, ['Open', 'Invalid', 'Resolved'], {}, :onchange => "openEmailForm()" %>
      </h3>
    <hr>
      <h3>Email Form:</h3>
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#reporter" aria-controls="reporter" role="tab" data-toggle="tab">Reporter</a></li>
        <li role="presentation"><a href="#offender" aria-controls="offender" role="tab" data-toggle="tab">Offender</a></li>
        <li role="presentation"><a href="#victim" aria-controls="victim" role="tab" data-toggle="tab">Victim</a></li>
      </ul>

      <div class="tab-content">
        <div role="tabpanel" class="tab-pane fade in active" id="reporter">
          <h3>
            Send to:
            <br>
            <%= text_field_tag :reporter_email_to, feedback_message.reporter&.email, class: "form-control" %>
          </h3>
          <h3>Subject:</h3>
            <%= text_field_tag :reporter_email_subject, reporter_email_details[:subject], class: "form-control" %>
          <h3>Body:</h3>
          <%= text_area_tag (:reporter_email_body), reporter_email_details[:body], class: "form-control", style: "height: 300px;" %>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="offender">
          <h3>
            Send to:
            <br>
            <%= email_field_tag :offender_email_to, feedback_message.offender&.email, class: "form-control" %>
          </h3>
          <h3>Subject:</h3>
            <%= text_field_tag :offender_email_subject, offender_email_details[:subject], class: "form-control" %>
          <h3>Body:</h3>
            <%= text_area_tag (:offender_email_body), offender_email_details[:body], class: "form-control", style: "height: 300px;" %>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="victim">
          <h3>
            Send to:
            <br>
            <%= text_field_tag :victim_email_to, feedback_message.victim&.email, class: "form-control" %>
          </h3>
          <h3>Subject:</h3>
            <%= text_field_tag :victim_email_subject, victim_email_details[:subject], class: "form-control" %>
          <h3>Body:</h3>
            <%= text_area_tag (:victim_email_body), victim_email_details[:body], class: "form-control", style: "height: 300px;" %>
        </div>
      </div>

      <br>
      <button class="btn btn-primary" type="button">SEND EMAIL ‚úâÔ∏è </button>

      <h3>Notes:</h3>
        <% feedback_message.notes&.order("created_at").each do |note| %>
          <p class="note-content">
            <%= note.author.name %>: <%= note.content %>
          </p>
        <% end %>
      <%= f.fields_for :note do |note| %>
        <%= note.hidden_field :reason, value: feedback_message.feedback_type %>
        <%= note.hidden_field :noteable_id, value: feedback_message.id %>
        <%= note.hidden_field :noteable_type, value: "FeedbackMessage" %>
        <%= note.hidden_field :author_id, value: current_user.id %>
        <%= note.text_area :content, placeholder: "Leave some notes about the status and context of this report.", class: "notefield", required: true %>
      <% end %>

      <br>
    <button class="btn btn-primary" type="submit">SUBMIT NOTE üìù </button>

      </div>
    </div>
  </div>
</div>

<script>
</script>
